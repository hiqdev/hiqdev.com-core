---
title: Альтернативная организация проекта на Yii2
---

# Альтернативная организация проекта на Yii2

Как предлагается создавать проект на Yii2 сейчас? Выбираете шаблон проекта basic или
advanced, форкаете себе, потом пишете и комитите туда. Бам! Случилась копипаста, ваш
проект и шаблон теперь развиваются отдельно. Вам не получить исправлений внесенных в
шаблон, а в yii2-app-basic естественно не возьмут доработок специфических для вашей
задачи. Это первая проблема.

Как расширяется проект на Yii2? Выбираете подходящие расширения и подключаете их с
помощью композера. Смотрите пример конфига этого расширения в README и копипастите в
конфиг своего приложения. Оопс... Опять копипаста. Вылазящяя разными боками, в том числе
таким: в большом проекте используется много расширений и конфиг приложения становится
огромным и просто нечитаемым.

Как эти проблемы связаны? Первая решается так: выделяем переиспользуемый код и
превращаем в расширение. И снова здравствуйте: у расширения есть свой конфиг -
получили вторую проблему.

Наибольшее значение эти проблемы имеют для повторно используемых решений когда вам
надо поднять в принципе один и тот же проект, но с маленькими/средними/большими
изменениями.
Но избавление от копипасты и переиспользование кода ещё никому не мешало.

Хочу поделиться своим вариантом решения этих проблем.

## Иерархия пакетов

Не буду томить душу, изложу суть сразу, чтоб если-что было удобненько расплеваться сразу
не дочитывая до конца.

Итак, решение такое: с самого-самого начала создавать свой проект как плагин (расширение
вместе с конфигом), делить проект на плагины и собирать конфиг приложения (точнее
приложений: web, консоль и др.) автоматически из конфигов плагинов.

Самый простой вариант организации проекта такой: наш проект реквайрит композером
фреймворк и *сторонние* расширения (*"сторонними"* я называю не являющиеся частью нашего
проекта), т.е. получается такая простая иерархия пакетов (репозиториев):

- проект (скопирован с шаблона приложения)
    - расширения
    - фреймворк

Пропускаю все промежуточные варианты проверенные и отброшенные по итогам практической
эксплуатации. И перехожу сразу к оптимальной иерархии которой я придерживаюсь сейчас:

- *"обёртка"*
    - плагины специфичные для данного варианта проекта
    - проект
        - плагины проекта
        - *сторонние* плагины
        - базовый проект
            - плагины нужные для работы базового проекта
            - фреймворк

Воу-воу! Полегче! Что за "обёртка" и "базовый проект"?
Извиняюсь, всё придумал сам, терминологии подходящей не нашёл, пришлось велосипедить, буду признателен за лучшие варианты.
самомоу.

*"Обёрткой"* я называю самый внешний пакет, ему достаточно содержать только
`composer.json` и конфиг специфический для данного конкретного варианта реализации вашего проекта.
*"Обёртка"* является шаблоном и это единственный код подлежащий копипастингу с
последующим тюнингом, но копипасты минимум - весь дефолтный конфиг должен быть
в проекте и плагинах.

"Базовый проект" это то во что превращается `yii2-app-basic` в этой схеме.
Т.е. очень сильно переиспользуемая основа приложения реализующая некий базовый
функционал и оформленная в виде плагина.
Эта запчасть не обязательна, но очень полезна. Вам не надо её делать самому, она
может разрабатываться сообществом как сейчас разрабатывается `yii2-app-basic`.

Аааа! Нужен пример!

Например вы делаете на потоке сайты визитки. Базовый функционал везде одинаковый
но есть фичи за дополнительну плату, например каталог и естественно сайты отличаются
внешним видом (темой) и кучей параметров.
Это можно организовать в такую иерархию пакетов:

- *"обёртка"*: mylab/my-new-site.com
    - mylab/yii2-theme-cool - плагин специфичный для данного сайта
    - mylab/business-card - основной проект
        - mylab/business-card-catalog - плагин проекта
        - yiisoft/yii2-debug - *сторонний* плагин
        - hiqdev/hisite - базовый проект
            - hiqdev/yii2-thememanager - плагин нужный для работы базового проекта
            - yiisoft/yii2 - фреймворк

## HiSite

Одно из *"базовых приложений"* которые мы развиваем - **HiSite**.
https://github.com/hiqdev/hisite

Шаблон *"обёртки"* здесь -
https://github.com/hiqdev/hisite-template


Структура каталогов "обёртки", несущественные файлы опущены:

- composer.json
- src/
    - config/
        - defines.php
        - params.php
- web/
    - index.php
- vendor/

Структура каталогов проекта:

- asset-packagist/
    - src/
        - config/
            - params.php
            - hisite.php
        - controllers
        - views

## Composer Config Plugin

